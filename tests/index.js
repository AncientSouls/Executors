'use strict';var _typeof=typeof Symbol==='function'&&typeof Symbol.iterator==='symbol'?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==='function'&&obj.constructor===Symbol&&obj!==Symbol.prototype?'symbol':typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _chai=require('chai');var _async=require('async');var _async2=_interopRequireDefault(_async);var _each=require('async/each');var _each2=_interopRequireDefault(_each);var _lodash=require('lodash');var _lodash2=_interopRequireDefault(_lodash);var _colors=require('colors');var _colors2=_interopRequireDefault(_colors);var _pProps=require('p-props');var _pProps2=_interopRequireDefault(_pProps);var _documents=require('./documents');var _documents2=_interopRequireDefault(_documents);var _implementation=require('../lib/implementation');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}require('source-map-support').install();function getEnv(callback){var cache={};function _get(query){if(!cache[query]){if(query=='js')cache[query]=new Item(_implementation.js);else if(!_documents2.default[query])return Promise.reject('Data by query '+query+' not founded.');else cache[query]=new Item(_documents2.default[query])}return cache[query].mount()};var Item=function(_ProtoItem){_inherits(Item,_ProtoItem);function Item(){_classCallCheck(this,Item);return _possibleConstructorReturn(this,(Item.__proto__||Object.getPrototypeOf(Item)).apply(this,arguments))}_createClass(Item,[{key:'get',value:function get(query){return _get(query)}}]);return Item}(_implementation.Item);function assertAllUnmounted(){for(var c in cache){_chai.assert.isFalse(cache[c].isMounted())}};return new Promise(function(resolve){resolve(callback(_get,cache,assertAllUnmounted))})}describe('AncientSouls/Funicular',function(){// g:t(text)=test
// text:text(js)=Object
it('should unmount type as parent',function(){return getEnv(function(get,cache,assertAllUnmounted){return get('g')// Is item mounted?
.then(function(g){return _chai.assert.equal(g.getResult(),'test')||g})// Is type mounted?
.then(function(g){return get('text').then(function(text){return _chai.assert.isTrue(text.isMounted())}).then(function(){return g})}).then(function(g){return g.unmount()})// Is item unmounted?
.then(function(g){return _chai.assert.isFalse(g.isMounted())||g})// Is type unmounted?
.then(function(g){return _chai.assert.isFalse(cache.text.isMounted())||g}).then(function(g){return assertAllUnmounted()})})});// c:x(js)={ a:z(js)=1, b:y(js)=2 }=3
// f:u(js)={ a:z(js)=1, b:y(js)=2 }='12'
it('should unmount only items without parents',function(){return getEnv(function(get,cache,assertAllUnmounted){return get('c').then(function(c){return get('f')}).then(function(f){// Is items mounted?
_chai.assert.equal(f.getResult(),'12');_chai.assert.equal(f.childs.a.getResult(),1);_chai.assert.equal(f.childs.b.getResult(),2);return f}).then(function(f){return f.unmount()}).then(function(f){// Is items unmounted?
_chai.assert.isFalse(f.isMounted());_chai.assert.isTrue(f.childs.a.isMounted());_chai.assert.isTrue(f.childs.b.isMounted());return f}).then(function(f){return get('c').then(function(c){// Is items mounted?
_chai.assert.equal(c.getResult(),3);_chai.assert.equal(c.childs.a.getResult(),1);_chai.assert.equal(c.childs.b.getResult(),2);return c}).then(function(c){return c.unmount()}).then(function(c){// Is items unmounted?
_chai.assert.isFalse(c.isMounted());_chai.assert.isFalse(c.childs.a.isMounted());_chai.assert.isFalse(c.childs.b.isMounted());return c}).then(function(c){return f})}).then(function(f){return assertAllUnmounted()})})});// c:x(js)={ a:z(js)=1, b:y(js)=2 }=3
it('js concept',function(){return getEnv(function(get,cache,assertAllUnmounted){return get('c').then(function(c){// Is items mounted?
_chai.assert.equal(c.getResult(),3);_chai.assert.equal(c.childs.a.getResult(),1);_chai.assert.equal(c.childs.b.getResult(),2);return c}).then(function(c){return c.unmount()}).then(function(c){// Is items unmounted?
_chai.assert.isFalse(c.isMounted());_chai.assert.isFalse(c.childs.a.isMounted());_chai.assert.isFalse(c.childs.b.isMounted());return c}).then(function(c){return assertAllUnmounted()})})});// e:v(js)={ document:document(js)=Object, d:w=String }=String
// document = [w,e]
it('css concept',function(){return getEnv(function(get,cache,assertAllUnmounted){return get('e').then(function(c){// Is items mounted?
_chai.assert.equal(c.getResult(),'<div>123</div>');_chai.assert.equal(_typeof(c.childs.document.getResult()),'object');_chai.assert.equal(c.childs.d.getResult(),'body { color: red; }');return c}).then(function(c){return get('document').then(function(document){// Document has been generated?
_chai.assert.deepEqual(document.getResult().getResults(),['body { color: red; }','<div>123</div>']);return document}).then(function(document){return c})}).then(function(c){return c.unmount()}).then(function(c){// Is items unmounted?
_chai.assert.isFalse(c.isMounted());_chai.assert.isFalse(c.childs.d.isMounted());_chai.assert.isFalse(c.childs.document.isMounted());return c}).then(function(c){return assertAllUnmounted()})})})});
//# sourceMappingURL=index.js.map