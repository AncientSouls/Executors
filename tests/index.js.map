{"version":3,"sources":["../src/tests/index.js"],"names":["require","install","generateGraph","collection","id","childs","generateFunicular","graph","funicular","OldCarriage","Carriage","callback","on","oldData","newData","name","updated","removed","get","undefined","error","data","fetched","describe","it","carriage","deepProperty","done","insert","mount","ifError","instanceOf","equal","stage"],"mappings":"wgBAEA,0BACA,2BACA,2CACA,4B,w6BALAA,QAAQ,oBAAR,EAA8BC,OAA9B,GAOA,QAASC,cAAT,EAAwC,IAAjBC,WAAiB,2DAAJ,EAAI,CACtC,MAAO,+BAAgBA,UAAhB,CAA4B,CAAEC,GAAI,IAAN,CAAYC,OAAQ,QAApB,CAA5B,CACR,EAED,QAASC,kBAAT,EAAoD,IAAzBC,MAAyB,2DAAjBL,eAAiB,CAClD,GAAIM,WAAY,kBAAhB,CAEA,GAAIC,aAAcD,UAAUE,QAA5B,CACAF,UAAUE,QAAV,qRACYC,QADZ,CACsB,iBAClBJ,MAAMK,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,CAAuB,CACxC,GAAIA,QAAQV,EAAR,EAAc,OAAKW,IAAvB,CAA6B,OAAKC,OAAL,CAAaF,OAAb,CAC9B,CAFD,EAGAP,MAAMK,EAAN,CAAS,QAAT,CAAmB,SAACC,OAAD,CAAUC,OAAV,CAAuB,CACxC,GAAIA,QAAQV,EAAR,EAAc,OAAKW,IAAvB,CAA6B,OAAKE,OAAL,EAC9B,CAFD,EAGAV,MAAMW,GAAN,CAAU,KAAKH,IAAf,CAAqBI,SAArB,CAAgC,SAACC,KAAD,CAAQC,IAAR,CAAiB,CAC/C,OAAKC,OAAL,CAAaF,KAAb,CAAoBC,IAApB,EACAV,UACD,CAHD,EAIA,MAAO,WAAM,CAAE,CAChB,CAbH,mBAAmCF,WAAnC,EAgBA,MAAOD,UACR,EAEDe,SAAS,wBAAT,CAAmC,UAAW,CAC5CC,GAAG,eAAH,CAAoB,UAAW,CAC7BlB,mBACD,CAFD,EAGAkB,GAAG,wBAAH,CAA6B,UAAW,CACtC,GAAIhB,WAAYF,mBAAhB,CACA,GAAImB,UAAW,GAAIjB,WAAUE,QAAd,CAAuB,KAAvB,CAAf,CACA,aAAOgB,YAAP,CAAoBlB,SAApB,CAA+B,iBAAiBiB,SAASrB,EAAzD,CACD,CAJD,EAKAoB,GAAG,iBAAH,CAAsB,SAASG,IAAT,CAAe,CACnC,GAAIpB,OAAQL,eAAZ,CACAK,MAAMqB,MAAN,CAAa,CAAExB,GAAI,KAAN,CAAb,EACA,GAAII,WAAYF,kBAAkBC,KAAlB,CAAhB,CACAC,UAAUqB,KAAV,CAAgB,KAAhB,CAAuB,SAACT,KAAD,CAAQK,QAAR,CAAqB,CAC1C,aAAOK,OAAP,CAAeV,KAAf,EACA,aAAOW,UAAP,CAAkBN,QAAlB,gBACA,aAAOC,YAAP,CAAoBD,QAApB,CAA8B,SAA9B,EACA,aAAOO,KAAP,CAAaP,SAASJ,IAAT,CAAcjB,EAA3B,CAA+B,KAA/B,EACA,aAAO4B,KAAP,CAAaP,SAASQ,KAAtB,CAA6B,SAA7B,EACAN,MACD,CAPD,CAQD,CAZD,CAaD,CAtBD","file":"index.js","sourcesContent":["require('source-map-support').install();\n\nimport { assert } from 'chai';\nimport { Funicular, Carriage } from '../lib';\nimport { ObjectGraph } from 'ancient-graph';\nimport async from 'async';\n\nfunction generateGraph(collection = []) {\n  return new ObjectGraph(collection, { id: 'id', childs: 'childs', });\n};\n\nfunction generateFunicular(graph = generateGraph()) {\n  var funicular = new Funicular();\n  \n  var OldCarriage = funicular.Carriage;\n  funicular.Carriage = class extends OldCarriage {\n    subscribe(callback) {\n      graph.on('update', (oldData, newData)  => {\n        if (newData.id == this.name) this.updated(newData);\n      });\n      graph.on('remove', (oldData, newData)  => {\n        if (newData.id == this.name) this.removed();\n      });\n      graph.get(this.name, undefined, (error, data) => {\n        this.fetched(error, data);\n        callback();\n      });\n      return () => {};\n    }\n  }\n  \n  return funicular;\n}; \n\ndescribe('AncientSouls/Funicular', function() {\n  it('new Funicular', function() {\n    generateFunicular();\n  });\n  it('new funicular.Carriage', function() {\n    var funicular = generateFunicular();\n    var carriage = new funicular.Carriage('abc');\n    assert.deepProperty(funicular, 'carriages.abc.'+carriage.id);\n  });\n  it('funicular.mount', function(done) {\n    var graph = generateGraph();\n    graph.insert({ id: 'abc' });\n    var funicular = generateFunicular(graph);\n    funicular.mount('abc', (error, carriage) => {\n      assert.ifError(error);\n      assert.instanceOf(carriage, Carriage);\n      assert.deepProperty(carriage, 'data.id');\n      assert.equal(carriage.data.id, 'abc');\n      assert.equal(carriage.stage, 'fetched');\n      done();\n    });\n  });\n});"]}