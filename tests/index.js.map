{"version":3,"sources":["../src/tests/index.js"],"names":["require","install","describe","generateManager","callback","prepared","undefined","mounted","it","done","manager","get","prepare","error","item","ifError","isTrue","isPrepared","equal","_items","a","mount","isMounted","remount","oldE","oldI","newE","newI","isUnmounted","isNotOk","isOk","unmount","memory","data","name","c","childs","prepareChild","child","next","mountChild","b","d","e","f","exports","type","eval","unmounted"],"mappings":"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","file":"index.js","sourcesContent":["require('source-map-support').install();\n\nimport { assert } from 'chai';\nimport { Manager, Item } from '../lib';\nimport { ObjectGraph } from 'ancient-graph';\nimport async from 'async';\nimport each from 'async/each';\n\ndescribe('AncientSouls/Funicular', () => {\n  describe('core', () => {\n    function generateManager() {\n      return new Manager(\n        class extends Item {\n          preparation(callback) {\n            this.prepared(undefined, callback);\n          }\n          mounting(callback) {\n            this.mounted(undefined, callback);\n          }\n        }\n      );\n    };\n    \n    it('should check full lifecicle of one item', (done) => {\n      var manager = generateManager();\n      \n      manager\n        .get('a')\n        .prepare((error, item) => {\n          assert.ifError(error);\n          assert.isTrue(item.isPrepared);\n          assert.equal(manager._items.a, item);\n          \n          item.mount((error, item) => {\n            assert.ifError(error);\n            assert.isTrue(item.isMounted);\n            \n            item.remount(undefined, (oldE, oldI, newE, newI) => {\n              assert.ifError(oldE);\n              assert.ifError(newE);\n              \n              assert.isTrue(oldI.isUnmounted);\n              assert.isTrue(newI.isMounted);\n              assert.isNotOk(newI.isUnmounted);\n              \n              assert.isOk(manager._items.a == newI);\n              assert.isNotOk(manager._items.a == oldI);\n              \n              newI.unmount((error, item) => {\n                assert.ifError(error);\n                assert.isTrue(item.isUnmounted);\n                assert.isNotOk(manager._items.a);\n                \n                done();\n              })\n            });\n          });\n        })\n      ;\n    });\n  });\n  describe('hierarchical', () => {\n    function generateManager(memory) {\n      return new Manager(\n        class extends Item {\n          preparation(callback) {\n            this.data = memory[this.name];\n            for (var c in this.data.childs) {\n              this.prepareChild(this.data.childs[c]);\n            }\n            this.prepared(undefined, callback);\n          }\n          mounting(callback) {\n            each(this.childs, (child, next) => {\n              this.mountChild(child, () => {\n                next();\n              });\n            }, () => this.mounted(undefined, callback));\n          }\n        }\n      );\n    };\n    \n    it('should prepare, mount, unmount all', (done) => {\n      var memory = {\n        a: { childs: ['b'] },\n        b: { childs: ['c'] },\n        c: {},\n      };\n      \n      var manager = generateManager(memory);\n      \n      manager\n        .get('a')\n        .prepare((error, item) => {\n          assert.ifError(error);\n          \n          var a = item;\n          var b = item.childs.b;\n          var c = item.childs.b.childs.c;\n          \n          assert.equal(manager._items.a, a);\n          assert.equal(manager._items.b, b);\n          assert.equal(manager._items.c, c);\n          \n          assert.isTrue(a.isPrepared);\n          assert.isTrue(b.isPrepared);\n          assert.isTrue(c.isPrepared);\n          \n          item.mount((error, item) => {\n            assert.ifError(error);\n            \n            assert.isTrue(a.isMounted);\n            assert.isTrue(b.isMounted);\n            assert.isTrue(c.isMounted);\n            \n            item.unmount((error, item) => {\n              assert.isNotOk(manager._items.a);\n              assert.isNotOk(manager._items.b, b);\n              assert.isNotOk(manager._items.c, c);\n              \n              assert.isTrue(a.isUnmounted);\n              assert.isTrue(b.isUnmounted);\n              assert.isTrue(c.isUnmounted);\n              \n              done();\n            })\n          });\n        })\n      ;\n    });\n    \n    it('should check simple recursion', (done) => {\n      var memory = {\n        a: { childs: ['b'] },\n        b: { childs: ['c'] },\n        c: { childs: ['a'] },\n      };\n      \n      var manager = generateManager(memory);\n      \n      manager\n        .get('a')\n        .prepare((error, item) => {\n          assert.ifError(error);\n          \n          var a = item;\n          var b = item.childs.b;\n          var c = item.childs.b.childs.c;\n          \n          assert.equal(manager._items.a, a);\n          assert.equal(manager._items.b, b);\n          assert.equal(manager._items.c, c);\n          \n          assert.isTrue(a.isPrepared);\n          assert.isTrue(b.isPrepared);\n          assert.isTrue(c.isPrepared);\n          \n          item.mount((error, item) => {\n            assert.ifError(error);\n            \n            assert.isTrue(a.isMounted);\n            assert.isTrue(b.isMounted);\n            assert.isTrue(c.isMounted);\n            \n            item.unmount((error, item) => {\n              assert.isNotOk(manager._items.a);\n              assert.isNotOk(manager._items.b, b);\n              assert.isNotOk(manager._items.c, c);\n              \n              assert.isTrue(a.isUnmounted);\n              assert.isTrue(b.isUnmounted);\n              assert.isTrue(c.isUnmounted);\n              \n              done();\n            })\n          });\n        })\n      ;\n    });\n    \n    it('should check many recursions', (done) => {\n      var memory = {\n        a: { childs: ['b'] },\n        b: { childs: ['c'] },\n        c: { childs: ['a', 'd'] },\n        d: { childs: ['e'] },\n        e: { childs: ['f'] },\n        f: { childs: ['d', 'a'] },\n      };\n      \n      var manager = generateManager(memory);\n      \n      manager\n        .get('a')\n        .prepare((error, item) => {\n          assert.ifError(error);\n          \n          var a = item;\n          var b = item.childs.b;\n          var c = b.childs.c;\n          var d = c.childs.d;\n          var e = d.childs.e;\n          var f = e.childs.f;\n          \n          assert.equal(manager._items.a, a);\n          assert.equal(manager._items.b, b);\n          assert.equal(manager._items.c, c);\n          assert.equal(manager._items.d, d);\n          assert.equal(manager._items.e, e);\n          assert.equal(manager._items.f, f);\n          \n          assert.isTrue(a.isPrepared);\n          assert.isTrue(b.isPrepared);\n          assert.isTrue(c.isPrepared);\n          assert.isTrue(d.isPrepared);\n          assert.isTrue(e.isPrepared);\n          assert.isTrue(f.isPrepared);\n          \n          item.mount((error, item) => {\n            assert.ifError(error);\n            \n            assert.isTrue(a.isMounted);\n            assert.isTrue(b.isMounted);\n            assert.isTrue(c.isMounted);\n            assert.isTrue(d.isMounted);\n            assert.isTrue(e.isMounted);\n            assert.isTrue(f.isMounted);\n            \n            item.unmount((error, item) => {\n              assert.isNotOk(manager._items.a);\n              assert.isNotOk(manager._items.b);\n              assert.isNotOk(manager._items.c);\n              assert.isNotOk(manager._items.d);\n              assert.isNotOk(manager._items.e);\n              assert.isNotOk(manager._items.f);\n              \n              assert.isTrue(a.isUnmounted);\n              assert.isTrue(b.isUnmounted);\n              assert.isTrue(c.isUnmounted);\n              assert.isTrue(d.isUnmounted);\n              assert.isTrue(e.isUnmounted);\n              assert.isTrue(f.isUnmounted);\n              \n              done();\n            })\n          });\n        })\n      ;\n    });\n  });\n  describe('realistic', () => {\n    function generateManager(memory) {\n      return new Manager(\n        class extends Item {\n          preparation(callback) {\n            this.data = memory[this.name];\n            for (var c in this.data.childs) {\n              this.prepareChild(this.data.childs[c]);\n            }\n            this.exports = {};\n            this.prepared(undefined, callback);\n          }\n          mounting(callback) {\n            var item = this;\n            each(this.childs, (child, next) => {\n              this.mountChild(child, () => {\n                next();\n              });\n            }, () => {\n              if (this.data.type == 'js') {\n                eval(this.data.data);\n              } else if (this.data.type == 'css') {\n                this.exports = this.data.data;\n                this.manager.get('a').exports[this.name] = this.exports;\n              } else if (this.data.type == 'root') {\n              }\n              this.mounted(undefined, callback);\n            });\n          }\n          unmounting(callback) {\n            for (var c in this.childs) {\n              this.childs[c].unmount();\n            }\n            if (this.data.type == 'css') {\n              delete this.manager.get('a').exports[this.name];\n            }\n            this.unmounted(undefined, callback);\n          }\n        }\n      );\n    };\n    \n    it('should check fake js and css items', (done) => {\n      var memory = {\n        a: { childs: ['b'], type: 'root' },\n        b: { childs: ['c', 'e'], type: 'js', data: 'item.exports = item.data' },\n        c: { childs: ['d'], type: 'js', data: 'item.exports = item.data' },\n        d: { type: 'css', data: 'body { color: black; }' },\n        e: { childs: ['d'], type: 'js', data: 'item.exports = item.data' },\n      };\n      \n      var manager = generateManager(memory);\n      \n      manager\n        .get('a')\n        .prepare((error, item) => {\n          item.mount((error, item) => {\n            assert.equal(manager._items.a.data, memory.a);\n            assert.equal(manager._items.b.data, memory.b);\n            assert.equal(manager._items.c.data, memory.c);\n            assert.equal(manager._items.d.data, memory.d);\n            assert.equal(manager._items.e.data, memory.e);\n            \n            assert.equal(item.exports.d, manager._items.d.exports);\n            \n            item.unmount((error, item) => {\n              assert.isNotOk(manager._items.a);\n              assert.isNotOk(manager._items.b);\n              assert.isNotOk(manager._items.c);\n              assert.isNotOk(manager._items.d);\n              assert.isNotOk(manager._items.e);\n            \n              assert.isNotOk(item.exports.d);\n              \n              done();\n            });\n          });\n        })\n      ;\n    });\n  });\n});"]}